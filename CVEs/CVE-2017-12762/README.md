# CVE-2017-12762


| CVE id | CVSS | Summary | reference |
| :----- | :--- | :------ | :-------- |
| CVE-2017-12762 | 10.0 | In /drivers/isdn/i4l/isdn_net.c: A user-controlled buffer is copied into a local buffer of constant size using strcpy without a length check which can cause a buffer overflow. This affects the Linux kernel 4.9-stable tree, 4.12-stable tree, 3.18-stable tree, and 4.4-stable tree. | http://www.securityfocus.com/bid/100251, https://patchwork.kernel.org/patch/9880041/ |

### STUDY

In isdn_ioctl function, bname buf is copied from argv(user buffer) (/drivers/isdn/i4l/isdn_common.c:1377) and the function calls isdn_net_newslave fucntion(:1384). isdn_net_newslave function calls strcpy without length check which can copy from user buffer(arg) (isdn_net.c:2615).


  --- a/drivers/isdn/i4l/isdn_net.c
  +++ b/drivers/isdn/i4l/isdn_net.c
  @@ -2611,10 +2611,9 @@  isdn_net_newslave(char *parm)
 	  char newname[10];
 
 	  if (p) {
  -/* Slave-Name MUST not be empty */
  -if (!strlen(p + 1))
  +		/* Slave-Name MUST not be empty or overflow 'newname' */
  +		if (strscpy(newname, p + 1, sizeof(newname)) <= 0)
   			return NULL;
  -		strcpy(newname, p + 1);
  		*p = 0;
  		/* Master must already exist */
  		if (!(n = isdn_net_findif(parm)))
